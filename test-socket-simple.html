<!DOCTYPE html>
<html>
<head>
    <title>Test Socket.IO Simple</title>
    <script src="https://cdn.socket.io/4.8.1/socket.io.min.js"></script>
</head>
<body>
    <div id="status">Connexion en cours...</div>
    <div id="messages"></div>
    
    <script>
        console.log('ğŸš€ Initialisation du client Socket.IO...');
        
        const socket = io('/api/socket', {
            auth: {
                sessionToken: 'test',
                userId: 'test-user',
                userRole: 'client',
                userName: 'Test User',
                userEmail: 'test@example.com'
            },
            transports: ['websocket', 'polling']
        });

        const statusDiv = document.getElementById('status');
        const messagesDiv = document.getElementById('messages');

        function addMessage(msg) {
            const p = document.createElement('p');
            p.innerHTML = new Date().toLocaleTimeString() + ' - ' + msg;
            messagesDiv.appendChild(p);
        }

        socket.on('connect', () => {
            console.log('âœ… Socket.IO Connected!');
            statusDiv.innerHTML = 'âœ… ConnectÃ© au Socket.IO';
            statusDiv.style.color = 'green';
            addMessage('Socket.IO connectÃ© avec succÃ¨s');
        });

        socket.on('disconnect', () => {
            console.log('âŒ Socket.IO Disconnected');
            statusDiv.innerHTML = 'âŒ DÃ©connectÃ©';
            statusDiv.style.color = 'red';
            addMessage('Socket.IO dÃ©connectÃ©');
        });

        socket.on('connect_error', (error) => {
            console.error('âŒ Socket.IO Error:', error);
            statusDiv.innerHTML = 'âŒ Erreur: ' + error.message;
            statusDiv.style.color = 'red';
            addMessage('Erreur: ' + error.message);
        });

        socket.on('error', (error) => {
            console.error('ğŸš« Server Error:', error);
            addMessage('Erreur serveur: ' + error.message);
        });

        console.log('ğŸ“¡ Client configurÃ©');
    </script>
</body>
</html>